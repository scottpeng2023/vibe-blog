# ğŸ“‹ åšå®¢ç³»ç»Ÿé¡¹ç›®çº§å¼€å‘è§„èŒƒ (Qoder Project Rules)

> **ç‰ˆæœ¬**: 1.0
> **å…³è”æ–‡æ¡£**: [spec-new.md](./spec-new.md)

---

## 1. æŠ€æœ¯æ ˆçº¦æŸ (Tech Stack)

- **æ¡†æ¶**: Next.js 14+ (å¿…é¡»ä½¿ç”¨ App Router æ¨¡å¼)
- **UI**: shadcn/ui + Tailwind CSS
- **åç«¯/æ•°æ®åº“**: Supabase (PostgreSQL + Auth + Storage)
- **è¡¨å•**: react-hook-form + zod
- **è¯­è¨€**: TypeScript (ä¸¥æ ¼æ¨¡å¼)

---

## 2. ç›®å½•ç»“æ„è§„èŒƒ (Folder Structure)

æ‰€æœ‰ä»£ç å¿…é¡»éµå¾ªä»¥ä¸‹ç»“æ„ï¼š
- `src/app/`: è·¯ç”±å’Œé¡µé¢ç»„ä»¶ (Server Components ä¼˜å…ˆ)
- `src/components/ui/`: shadcn/ui åŸºç¡€ç»„ä»¶
- `src/components/blog/`: åšå®¢ä¸šåŠ¡ç‰¹å®šç»„ä»¶
- `src/components/layout/`: å…¨å±€å¸ƒå±€ç»„ä»¶ (Header, Footer, etc.)
- `src/lib/`: ç¬¬ä¸‰æ–¹åº“é…ç½® (å¦‚ `supabase/client.ts`) åŠå·¥å…·å‡½æ•°
- `src/hooks/`: è‡ªå®šä¹‰ React Hooks
- `src/types/`: TypeScript æ¥å£å’Œç±»å‹å®šä¹‰
- `src/constants/`: å¸¸é‡é…ç½®

---

## 3. å‘½åçº¦å®š (Naming Conventions)

- **æ–‡ä»¶**: ä½¿ç”¨ kebab-case (å¦‚ `post-card.tsx`, `use-auth.ts`)
- **ç»„ä»¶**: ä½¿ç”¨ PascalCase (å¦‚ `PostCard`)
- **å‡½æ•°/å˜é‡**: ä½¿ç”¨ camelCase (å¦‚ `getPostBySlug`)
- **å¸¸é‡**: ä½¿ç”¨ UPPER_SNAKE_CASE (å¦‚ `MAX_POSTS_PER_PAGE`)
- **ç±»å‹/æ¥å£**: ä½¿ç”¨ PascalCase (å¦‚ `interface UserProfile`)

---

## 4. å¼€å‘æ ¸å¿ƒåŸåˆ™ (Core Principles)

### 4.1 React & Next.js
- **æœåŠ¡ç«¯ä¼˜å…ˆ**: ä¼˜å…ˆä½¿ç”¨ Server Components è¿›è¡Œæ•°æ®æ‹‰å–ã€‚
- **å®¢æˆ·ç«¯æŒ‡ä»¤**: ä»…åœ¨éœ€è¦äº¤äº’ã€çŠ¶æ€æˆ–æµè§ˆå™¨ API æ—¶ä½¿ç”¨ `'use client'`ã€‚
- **æ¸²æŸ“ç­–ç•¥**: 
  - é¦–é¡µ/åˆ—è¡¨é¡µ: ä½¿ç”¨ ISR (Incremental Static Regeneration)ã€‚
  - æ–‡ç« è¯¦æƒ…é¡µ: ä½¿ç”¨ SSG + ISRã€‚
  - ç®¡ç†åå°: ä½¿ç”¨ CSRã€‚

### 4.2 Supabase & æ•°æ®åº“
- **RLS ä¼˜å…ˆ**: æ°¸è¿œä¸è¦å…³é—­æ•°æ®åº“è¡¨çš„ Row Level Securityã€‚
- **å®¢æˆ·ç«¯é€‰æ‹©**: 
  - æœåŠ¡ç«¯ä»£ç ä½¿ç”¨ `createRouteHandlerClient` æˆ– `createServerComponentClient`ã€‚
  - å®¢æˆ·ç«¯ä»£ç ä½¿ç”¨ `createClientComponentClient`ã€‚
- **ç´¢å¼•**: ä»»ä½•ç»å¸¸æŸ¥è¯¢çš„å­—æ®µï¼ˆå¦‚ `slug`, `author_id`ï¼‰å¿…é¡»åœ¨ Schema ä¸­å®šä¹‰ç´¢å¼•ã€‚

### 4.3 UI & æ ·å¼
- **å“åº”å¼**: å¿…é¡»å…¼å®¹ Mobile (375px+), Tablet, Desktopã€‚
- **çŠ¶æ€å¤„ç†**: å¼‚æ­¥æ“ä½œå¿…é¡»åŒ…å« Loading (Skeleton) å’Œ Error çŠ¶æ€å¤„ç†ã€‚
- **ç»„ä»¶åŒ–**: ä¸¥ç¦åœ¨é¡µé¢ä¸­ç›´æ¥ç¼–å†™å†—é•¿çš„ HTML ç»“æ„ï¼Œåº”æ‹†åˆ†ä¸ºå°é¢—ç²’åº¦çš„ç‹¬ç«‹ç»„ä»¶ã€‚

---

## 5. API ä¸é”™è¯¯å¤„ç†

### 5.1 ç»Ÿä¸€å“åº”æ ¼å¼
æ‰€æœ‰å†…éƒ¨ API å¿…é¡»éµå¾ªï¼š
```json
// æˆåŠŸ
{ "success": true, "data": { ... } }
// å¤±è´¥
{ "success": false, "error": { "code": "CODE", "message": "msg" } }
```

### 5.2 é”™è¯¯ç 
ä¸¥ç¦ä½¿ç”¨é­”æ³•æ•°å­—ï¼Œå¿…é¡»ä½¿ç”¨ `spec-new.md` ä¸­å®šä¹‰çš„é”™è¯¯ç ï¼ˆå¦‚ `UNAUTHORIZED`, `VALIDATION_ERROR`ï¼‰ã€‚

---

## 6. Git & åä½œè§„èŒƒ

### 6.1 æäº¤ä¿¡æ¯æ ¼å¼
`<type>(<scope>): <subject>`
- **type**: feat, fix, docs, style, refactor, test, chore
- **scope**: posts, auth, ui, api, db
- **ç¤ºä¾‹**: `feat(posts): add markdown editor support`

### 6.2 å¹¶è¡Œå¼€å‘å»ºè®®
å¤š Agent åä½œæ—¶ï¼š
- ä¿®æ”¹ UI ç»„ä»¶å‰å…ˆç¡®è®¤æ˜¯å¦å·²å­˜åœ¨äº `src/components/ui`ã€‚
- ä¸¥ç¦åœ¨æœªæ²Ÿé€šæƒ…å†µä¸‹ä¿®æ”¹å…¨å±€é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `tailwind.config.js`, `next.config.js`ï¼‰ã€‚

---

## 7. æµ‹è¯•è¦æ±‚

- **é€»è¾‘å‡½æ•°**: å¿…é¡»ç¼–å†™ Jest å•å…ƒæµ‹è¯•ã€‚
- **å…³é”®äº¤äº’**: æ ¸å¿ƒæµç¨‹ï¼ˆå¦‚å‘å¸ƒæ–‡ç« ã€è¯„è®ºï¼‰å»ºè®®ç¼–å†™ Playwright E2E æµ‹è¯•ã€‚
- **éªŒè¯**: æäº¤ PR å‰å¿…é¡»è¿è¡Œ `npm run lint` å’Œ `npm run build` ç¡®ä¿æ— é”™ã€‚
